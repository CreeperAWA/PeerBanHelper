import{u as le,e as De,c as Z,f as T,I as se,b as ie,_ as ce,i as Oe}from"./index-CjN0ujJ-.js";/* empty css              */import{f as re,a6 as pe,ak as Fe,a2 as e,j as c,s as p,t,y as a,v as l,x as s,p as V,k as ae,P as Be,F as Ke,u as m,a1 as oe,w as We,c as Ve,r as $e,a8 as Je,ae as Qe,o as Xe,M as Ye,N as Ze,E as Ae,m as et}from"./libs-D-uoNQCp.js";import{c as tt,d as at,e as nt}from"./data-CRLTlxDW.js";import{a5 as ot,S as ne,b as Ue,c as de,T as ue,t as Ee,E as lt,am as st,K as it,w as ct,ao as rt,j as pt,D as dt,L as ut,B as _t,h as gt,N as ft,ap as mt,aq as bt,ar as yt,$ as ht,ai as wt,C as St}from"./arcoDesign-BIo_4ded.js";import{I as kt}from"./index-CWJweRQ0.js";import{I as vt}from"./index-Dxs3HKZx.js";const It=re({__name:"accessHistoryTable",props:{ip:{}},setup(ee){const{t:u,d:o}=pe(),D=le(),{data:n,total:R,current:j,loading:L,pageSize:q,changeCurrent:y,changePageSize:F}=Fe(tt,{defaultParams:[{ip:ee.ip,page:1,pageSize:5}],pagination:{currentKey:"page",pageSizeKey:"pageSize",totalKey:"data.total"},cacheKey:g=>`${D.endpoint}-ipAccessHistory-${g==null?void 0:g[0].ip}-${(g==null?void 0:g[0].page)||1}-${(g==null?void 0:g[0].pageSize)||10}`}),B=[{title:()=>u("page.torrentList.accessHistory.column.downloader"),slotName:"downloader"},{title:"Peer ID",slotName:"peerId"},{title:()=>u("page.torrentList.accessHistory.column.traffic"),slotName:"traffic",width:120},{title:()=>oe(ne,[u("page.torrentList.accessHistory.column.offset"),oe(ot,{content:u("page.torrentList.accessHistory.column.offsetDescription")},()=>oe(Z))]),slotName:"offset",width:120},{title:()=>u("page.dashboard.peerList.column.flag"),slotName:"flags",width:120},{title:()=>u("page.torrentList.accessHistory.column.timeseen"),slotName:"time",width:260},{title:()=>u("page.ipList.accessHistory.column.torrent"),dataIndex:"torrent.name",ellipsis:!0,tooltip:!0}],U=g=>g.split(" ").map(i=>i+" - "+u("page.dashboard.peerList.column.flags."+i.trim()));return(g,i)=>{var P,E;const te=Ue,z=de,k=se,v=ue,h=ie,w=ne,I=Ee,f=lt;return(P=e(n))!=null&&P.data.results||e(L)?(c(),p(I,{key:0,stripe:!0,columns:B,data:(E=e(n))==null?void 0:E.data.results,loading:e(L),pagination:{total:e(R),current:e(j),pageSize:e(q),showPageSize:!0,baseSize:4,bufferSize:1},"column-resizable":"",size:"medium",class:"banlog-table",onPageChange:e(y),onPageSizeChange:e(F)},{downloader:t(({record:d})=>[a(te,{color:e(De)(d.downloader)},{default:t(()=>[l(s(d.downloader),1)]),_:2},1032,["color"])]),peerId:t(({record:d})=>[V("p",null,[l(s(d.peerId?d.peerId:e(u)("page.banlist.banlist.listItem.empty"))+" ",1),a(z,{content:d.clientName?d.clientName:e(u)("page.banlist.banlist.listItem.empty")},{default:t(()=>[a(e(Z))]),_:2},1032,["content"])])]),traffic:t(({record:d})=>[a(w,{fill:"",direction:"vertical"},{default:t(()=>[a(v,null,{default:t(()=>[a(k,{class:"green"}),l(" "+s(e(T)(d.uploaded)),1)]),_:2},1024),a(v,null,{default:t(()=>[a(h,{class:"red"}),l(" "+s(e(T)(d.downloaded)),1)]),_:2},1024)]),_:2},1024)]),offset:t(({record:d})=>[a(w,{fill:"",direction:"vertical"},{default:t(()=>[a(v,null,{default:t(()=>[a(k,{class:"green"}),l(" "+s(e(T)(d.uploadedOffset)),1)]),_:2},1024),a(v,null,{default:t(()=>[a(h,{class:"red"}),l(" "+s(e(T)(d.downloadedOffset)),1)]),_:2},1024)]),_:2},1024)]),flags:t(({record:d})=>[V("p",null,[l(s(d.lastFlags)+" ",1),d.lastFlags?(c(),p(z,{key:0},{content:t(()=>[(c(!0),ae(Ke,null,Be(U(d.lastFlags),_=>(c(),ae("p",{key:_},s(_),1))),128))]),default:t(()=>[a(e(Z))]),_:2},1024)):m("",!0)])]),time:t(({record:d})=>[a(w,{fill:"",direction:"vertical"},{default:t(()=>[a(v,null,{default:t(()=>[l(s(e(u)("page.torrentList.accessHistory.column.timeseen.first"))+": "+s(e(o)(d.firstTimeSeen,"long")),1)]),_:2},1024),a(v,null,{default:t(()=>[l(s(e(u)("page.torrentList.accessHistory.column.timeseen.last"))+": "+s(e(o)(d.lastTimeSeen,"long")),1)]),_:2},1024)]),_:2},1024)]),_:1},8,["data","loading","pagination","onPageChange","onPageSizeChange"])):(c(),p(f,{key:1,style:{height:"20vh","align-items":"center",display:"flex","justify-content":"center","flex-direction":"column"}},{default:t(()=>[l(s(e(u)("page.torrentList.accessHistory.empty")),1)]),_:1}))}}}),Lt=ce(It,[["__scopeId","data-v-72781067"]]),zt=re({__name:"banHistoryTable",props:{ip:{}},setup(ee){const u=le(),{t:o,d:D}=pe(),{data:n,total:R,current:j,loading:L,pageSize:q,changeCurrent:y,changePageSize:F,refresh:B}=Fe(at,{defaultParams:[{ip:ee.ip,page:1,pageSize:10}],pagination:{currentKey:"page",pageSizeKey:"pageSize",totalKey:"data.total"},cacheKey:i=>`${u.endpoint}-banlogs-${(i==null?void 0:i[0].page)||1}-${(i==null?void 0:i[0].pageSize)||10}`});We(()=>u.endpoint,B);const U=[{title:()=>o("page.banlog.banlogTable.column.banTime")+"/"+o("page.banlog.banlogTable.column.unbanTime"),slotName:"banAt",width:220},{title:()=>o("page.banlog.banlogTable.column.peerPort"),dataIndex:"peerPort",width:80},{title:()=>o("page.banlog.banlogTable.column.peerId"),slotName:"peerId",width:120},{title:()=>o("page.banlog.banlogTable.column.trafficSnapshot"),slotName:"peerStatus",width:150},{title:()=>o("page.banlog.banlogTable.column.torrentName"),dataIndex:"torrentName",ellipsis:!0,tooltip:!0},{title:()=>o("page.banlog.banlogTable.column.torrentSize"),slotName:"torrentSize",width:120},{title:()=>o("page.banlog.banlogTable.column.description"),dataIndex:"description",ellipsis:!0,tooltip:!0}],g=Ve(()=>{var i;return(i=n.value)==null?void 0:i.data.results});return(i,te)=>{const z=kt,k=ue,v=st,h=ne,w=se,I=ie,f=it,P=de,E=Z,d=Ee;return c(),p(d,{stripe:!0,columns:U,data:g.value,loading:e(L),pagination:{total:e(R),current:e(j),pageSize:e(q),showPageSize:!0,baseSize:4,bufferSize:1},"column-resizable":"",size:"medium",class:"banlog-table",onPageChange:e(y),onPageSizeChange:e(F)},{banAt:t(({record:_})=>[a(h,{fill:"",direction:"vertical"},{default:t(()=>[a(k,null,{default:t(()=>[a(z),l(" "+s(e(D)(_.banAt,"long")),1)]),_:2},1024),a(k,null,{default:t(()=>[a(v),l(" "+s(_.unbanAt?e(D)(_.unbanAt,"long"):e(o)("page.banlog.banlogTable.notUnbanned")),1)]),_:2},1024)]),_:2},1024)]),peerStatus:t(({record:_})=>[a(h,{fill:"",style:{"justify-content":"space-between"}},{default:t(()=>[a(h,{fill:"",direction:"vertical"},{default:t(()=>[a(k,null,{default:t(()=>[a(w,{class:"green"}),l(" "+s(e(T)(_.peerUploaded)),1)]),_:2},1024),a(k,null,{default:t(()=>[a(I,{class:"red"}),l(" "+s(e(T)(_.peerDownloaded)),1)]),_:2},1024)]),_:2},1024),a(P,{content:(_.peerProgress*100).toFixed(2)+"%"},{default:t(()=>[a(f,{percent:_.peerProgress,size:"mini"},null,8,["percent"])]),_:2},1032,["content"])]),_:2},1024)]),peerId:t(({record:_})=>[V("p",null,[l(s(_.peerId?_.peerId:e(o)("page.banlist.banlist.listItem.empty"))+" ",1),a(P,{content:_.peerClientName?_.peerClientName:e(o)("page.banlist.banlist.listItem.empty")},{default:t(()=>[a(E)]),_:2},1032,["content"])])]),torrentSize:t(({record:_})=>[a(P,{content:`Hash: ${_.torrentInfoHash}`},{default:t(()=>[V("p",null,s(e(T)(_.torrentSize)),1)]),_:2},1032,["content"])]),_:1},8,["data","loading","pagination","onPageChange","onPageSizeChange"])}}}),Tt=ce(zt,[["__scopeId","data-v-009c3e8f"]]),Pt={class:"center searchContainer"},xt={class:"result-container center"},Ct=re({__name:"index",setup(ee){const u=$e(""),{t:o,d:D}=pe(),{data:n,loading:R,run:j,error:L}=Je(nt,{manual:!0}),q=le(),y=Ve(()=>q.plusStatus),F=$e([]),{query:B}=Qe(),U=g=>{if(g){if(n.value=void 0,F.value=[],g!==B.ip){const i=new URLSearchParams(window.location.search);i.set("ip",g),window.history.pushState({},"",new URL(`${window.location.origin}${window.location.pathname}?${i.toString()}`))}j(g)}};return Xe(()=>{B.ip&&(u.value=B.ip,U(u.value))}),(g,i)=>{const te=ct,z=ue,k=rt,v=pt,h=Ue,w=de,I=ne,f=dt,P=se,E=ie,d=Z,_=ut,_e=_t,Re=gt,ge=ft,fe=mt,me=vt,be=bt,je=yt,qe=ht,Ge=wt,Me=St;return c(),p(I,{direction:"vertical",fill:"",class:"center"},{default:t(()=>{var ye,he;return[a(k,{style:{"text-align":"center"}},{default:t(()=>[a(te,null,{default:t(()=>[l(s(e(o)("page.ipList.title")),1)]),_:1}),a(z,null,{default:t(()=>[l(s(e(o)("page.ipList.description")),1)]),_:1})]),_:1}),V("div",Pt,[a(v,{modelValue:u.value,"onUpdate:modelValue":i[0]||(i[0]=K=>u.value=K),"search-button":"",placeholder:"192.168.1.1....",class:"searchBox",loading:e(R),onSearch:U},null,8,["modelValue","loading"])]),V("div",xt,[Ye(a(Me,{class:"result-card",style:et({minWidth:(ye=e(n))!=null&&ye.data.found?"1150px":"400px"}),hoverable:""},{default:t(()=>[e(L)?(c(),p(Ge,{key:1,status:"500",title:e(o)("page.ipList.error"),subtitle:e(L).message},{default:t(()=>[a(k,{style:{background:"var(--color-fill-2)",padding:"24px"}},{default:t(()=>{var K;return[a(qe,null,{default:t(()=>i[7]||(i[7]=[l("Details:")])),_:1}),V("ul",null,[(c(!0),ae(Ke,null,Be((K=e(L).stack)==null?void 0:K.split(`
`),b=>(c(),ae("li",{key:b},s(b),1))),128))])]}),_:1})]),_:1},8,["title","subtitle"])):(c(),p(I,{key:0,direction:"vertical",fill:""},{default:t(()=>{var K;return[a(Re,null,{title:t(()=>[a(I,null,{default:t(()=>{var b,x;return[l(s((b=e(n))==null?void 0:b.data.address)+" ",1),(x=e(n))!=null&&x.data.found?m("",!0):(c(),p(w,{key:0,content:e(o)("page.ipList.notfound.tips")},{default:t(()=>[a(h,null,{default:t(()=>i[2]||(i[2]=[l("Not found")])),_:1})]),_:1},8,["content"]))]}),_:1})]),default:t(()=>{var b,x,G,M,C,N,H,we,Se,ke,ve,Ie,Le,ze,Te,Pe,xe,Ce,Ne,He;return[(b=e(n))!=null&&b.data.found?(c(),p(f,{key:0,label:e(o)("page.ipList.label.banCount"),span:2},{default:t(()=>{var r;return[l(s((r=e(n))==null?void 0:r.data.banCount),1)]}),_:1},8,["label"])):m("",!0),(x=e(n))!=null&&x.data.found?(c(),p(f,{key:1,label:e(o)("page.ipList.label.torrentAccessCount"),span:2},{default:t(()=>{var r;return[l(s((r=e(n))==null?void 0:r.data.torrentAccessCount),1)]}),_:1},8,["label"])):m("",!0),(G=e(n))!=null&&G.data.found?(c(),p(f,{key:2,label:e(o)("page.ipList.label.uploadedToPeer"),span:2},{default:t(()=>[a(z,null,{default:t(()=>{var r;return[a(P,{class:"green"}),l(" "+s(e(T)(((r=e(n))==null?void 0:r.data.uploadedToPeer)??0)),1)]}),_:1})]),_:1},8,["label"])):m("",!0),(M=e(n))!=null&&M.data.found?(c(),p(f,{key:3,label:e(o)("page.ipList.label.downloadedFromPeer"),span:2},{default:t(()=>[a(z,null,{default:t(()=>{var r;return[a(E,{class:"red"}),l(" "+s(e(T)(((r=e(n))==null?void 0:r.data.downloadedFromPeer)??0)),1)]}),_:1})]),_:1},8,["label"])):m("",!0),(C=e(n))!=null&&C.data.found?(c(),p(f,{key:4,label:e(o)("page.ipList.label.firstTimeSeen"),span:2},{default:t(()=>{var r;return[l(s(e(D)(((r=e(n))==null?void 0:r.data.firstTimeSeen)??0,"long")),1)]}),_:1},8,["label"])):m("",!0),(N=e(n))!=null&&N.data.found?(c(),p(f,{key:5,label:e(o)("page.ipList.label.lastTimeSeen"),span:2},{default:t(()=>{var r;return[l(s(e(D)(((r=e(n))==null?void 0:r.data.lastTimeSeen)??0,"long")),1)]}),_:1},8,["label"])):m("",!0),(Se=(we=(H=e(n))==null?void 0:H.data.geo)==null?void 0:we.country)!=null&&Se.iso||(Ie=(ve=(ke=e(n))==null?void 0:ke.data.geo)==null?void 0:ve.city)!=null&&Ie.name?(c(),p(f,{key:6,label:e(o)("page.banlist.banlist.listItem.geo"),span:2},{default:t(()=>{var r,S,O,W,J,Q,X,Y;return[(S=(r=e(n).data.geo)==null?void 0:r.country)!=null&&S.iso?(c(),p(Oe,{key:0,iso:((W=(O=e(n).data.geo)==null?void 0:O.country)==null?void 0:W.iso)??""},null,8,["iso"])):m("",!0),l(" "+s(`${((Q=(J=e(n).data.geo)==null?void 0:J.country)==null?void 0:Q.name)??""} ${((Y=(X=e(n).data.geo)==null?void 0:X.city)==null?void 0:Y.name)??""}`),1)]}),_:1},8,["label"])):m("",!0),(Te=(ze=(Le=e(n))==null?void 0:Le.data.geo)==null?void 0:ze.network)!=null&&Te.isp?(c(),p(f,{key:7,label:e(o)("page.banlist.banlist.listItem.network.isp"),span:1},{default:t(()=>{var r,S;return[l(s((S=(r=e(n).data.geo)==null?void 0:r.network)==null?void 0:S.isp),1)]}),_:1},8,["label"])):m("",!0),(Ce=(xe=(Pe=e(n))==null?void 0:Pe.data.geo)==null?void 0:xe.network)!=null&&Ce.netType?(c(),p(f,{key:8,label:e(o)("page.banlist.banlist.listItem.network.netType"),span:2},{default:t(()=>{var r,S;return[l(s((S=(r=e(n).data.geo)==null?void 0:r.network)==null?void 0:S.netType),1)]}),_:1},8,["label"])):m("",!0),(He=(Ne=e(n))==null?void 0:Ne.data.geo)!=null&&He.as?(c(),p(f,{key:9,label:e(o)("page.banlist.banlist.listItem.asn"),span:2},{default:t(()=>[a(I,null,{default:t(()=>{var r,S,O,W,J,Q,X,Y;return[a(z,null,{default:t(()=>{var $,A;return[l(s((A=($=e(n).data.geo)==null?void 0:$.as)==null?void 0:A.organization),1)]}),_:1}),a(h,{color:e(De)((((S=(r=e(n).data.geo)==null?void 0:r.as)==null?void 0:S.number)??0).toString())},{default:t(()=>{var $,A;return[l(s((A=($=e(n).data.geo)==null?void 0:$.as)==null?void 0:A.number),1)]}),_:1},8,["color"]),a(w,{content:e(o)("page.banlist.banlist.listItem.asn.subnet")+((J=(W=(O=e(n).data.geo)==null?void 0:O.as)==null?void 0:W.network)==null?void 0:J.ipAddress)+"/"+((Y=(X=(Q=e(n).data.geo)==null?void 0:Q.as)==null?void 0:X.network)==null?void 0:Y.prefixLength)},{default:t(()=>{var $,A;return[a(_,{href:`https://2ip.io/analytics/asn-list/?asnId=${(A=($=e(n).data.geo)==null?void 0:$.as)==null?void 0:A.number}`,hoverable:!1},{default:t(()=>[a(d)]),_:1},8,["href"])]}),_:1},8,["content"])]}),_:1})]),_:1},8,["label"])):m("",!0),a(f,{span:8},{label:t(()=>[a(I,null,{default:t(()=>[l(s(e(o)("page.ipList.shortcut"))+" ",1),a(w,{content:e(o)("page.ipList.shortcut.tips")},{default:t(()=>[a(d)]),_:1},8,["content"])]),_:1})]),default:t(()=>[a(I,null,{default:t(()=>[a(_e,{href:`https://ip.ping0.cc/ip/${u.value}`,type:"outline"},{default:t(()=>i[3]||(i[3]=[l(" ping0 ")])),_:1},8,["href"]),a(_e,{href:`https://search.censys.io/hosts/${u.value}`,type:"outline"},{default:t(()=>i[4]||(i[4]=[l(" Censys ")])),_:1},8,["href"])]),_:1})]),_:1})]}),_:1}),(K=e(n))!=null&&K.data.found?(c(),p(je,{key:0,"active-key":F.value,bordered:!1,"destroy-on-hide":"",onChange:i[1]||(i[1]=b=>F.value.push(...b))},{default:t(()=>{var b,x,G,M;return[a(be,{key:"1",header:e(o)("page.ipList.label.accessHistory"),disabled:!((b=y.value)!=null&&b.activated),class:"collapse-table"},Ae({"expand-icon":t(({active:C})=>{var N,H;return[(N=y.value)!=null&&N.activated&&!C?(c(),p(ge,{key:0})):(H=y.value)!=null&&H.activated&&C?(c(),p(fe,{key:1})):(c(),p(me,{key:2}))]}),default:t(()=>[a(Lt,{ip:e(n).data.address},null,8,["ip"])]),_:2},[(x=y.value)!=null&&x.activated?void 0:{name:"extra",fn:t(()=>[a(w,{content:e(o)("page.ipList.plusLock")},{default:t(()=>[a(h,{size:"small"},{default:t(()=>i[5]||(i[5]=[l("Plus")])),_:1})]),_:1},8,["content"])]),key:"0"}]),1032,["header","disabled"]),a(be,{key:"2",header:e(o)("page.ipList.label.banHistory"),disabled:!((G=y.value)!=null&&G.activated)},Ae({"expand-icon":t(({active:C})=>{var N,H;return[(N=y.value)!=null&&N.activated&&!C?(c(),p(ge,{key:0})):(H=y.value)!=null&&H.activated&&C?(c(),p(fe,{key:1})):(c(),p(me,{key:2}))]}),default:t(()=>[a(Tt,{ip:e(n).data.address},null,8,["ip"])]),_:2},[(M=y.value)!=null&&M.activated?void 0:{name:"extra",fn:t(()=>[a(w,{content:e(o)("page.ipList.plusLock")},{default:t(()=>[a(h,{size:"small"},{default:t(()=>i[6]||(i[6]=[l("Plus")])),_:1})]),_:1},8,["content"])]),key:"0"}]),1032,["header","disabled"])]}),_:1},8,["active-key"])):m("",!0)]}),_:1}))]),_:1},8,["style"]),[[Ze,((he=e(n))==null?void 0:he.data)||e(L)]])])]}),_:1})}}}),Kt=ce(Ct,[["__scopeId","data-v-dc981cf5"]]);export{Kt as default};
