const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./dummyChart-DaUIKEy4.js","./echarts-BW6JoiTo.js","./libs-DwLy4rSt.js","./index-CdBkEPEl.js","./arcoDesign-BIdS7tcw.js","./index-v_fGC44D.css"])))=>i.map(i=>d[i]);
import{u as M,a as G,g as X,b as J,f as fe,_ as Ve,c as Re}from"./index-CdBkEPEl.js";import{u as Y,E as H,i as Q,a as ge,b as me,c as K,d as he,e as ve,f as Ae,g as Ie}from"./echarts-BW6JoiTo.js";import{f as I,a4 as z,c as P,r as A,a as Z,w as ee,a5 as te,j as _,s as w,t as s,y as r,a2 as o,v as f,x as h,u as Le,l as Pe,a6 as Ee,q as Ue,o as ze,I as Be,k as U,F as de,P as ce,A as ye,n as $e,M as Fe,N as je,p as pe}from"./libs-DwLy4rSt.js";import{aj as g,L as ae,R as Me,r as Ne,F as oe,ak as ie,t as se,a3 as ne,B as N,af as q,C as j,al as be,am as we,V as ke,T as De,S as xe,an as Se,e as Oe,w as qe,v as We}from"./arcoDesign-BIdS7tcw.js";import{I as Ge}from"./index-BRAjYYsC.js";async function Xe(p,e=!1){const t=M();await t.serverAvailable;const n=new URLSearchParams({type:"count",field:p,filter:e?"0.01":"0"}),a=new URL(G(t.endpoint,"api/statistic/analysis/field?"+n.toString()),location.href);return fetch(a,{headers:X()}).then(d=>(t.assertResponseLogin(d),d.json()))}async function Je(p,e,t){const n=M();await n.serverAvailable;const a=new URL(G(n.endpoint,"api/chart/geoIpInfo"),location.href),d=p.getTime(),l=e.getTime();return a.searchParams.append("startAt",d.toString()),a.searchParams.append("endAt",l.toString()),a.searchParams.append("bannedOnly",String(t)),fetch(a,{headers:X()}).then(v=>(n.assertResponseLogin(v),v.json()))}async function Ye(p,e,t){const n=M();await n.serverAvailable;const a=new URLSearchParams({startAt:p.getTime().toString(),endAt:e.getTime().toString(),type:t,field:"banAt"}),d=new URL(G(n.endpoint,"api/statistic/analysis/date?"+a.toString()),location.href);return fetch(d,{headers:X()}).then(l=>(n.assertResponseLogin(l),l.json()))}async function He(p,e){const t=M();await t.serverAvailable;const n=new URLSearchParams({startAt:p.getTime().toString(),endAt:e.getTime().toString()}),a=new URL(G(t.endpoint,"api/chart/trend?"+n.toString()),location.href);return fetch(a,{headers:X()}).then(d=>(t.assertResponseLogin(d),d.json()))}async function Qe(p,e){const t=M();await t.serverAvailable;const n=new URLSearchParams({startAt:p.getTime().toString(),endAt:e.getTime().toString()}),a=new URL(G(t.endpoint,"api/chart/traffic?"+n.toString()),location.href);return fetch(a,{headers:X()}).then(d=>(t.assertResponseLogin(d),d.json()))}const Ke=I({__name:"banLine",setup(p){const{t:e}=z(),t=P(()=>({text:e("page.charts.loading"),color:n.isDark?"rgb(60, 126, 255)":"rgb(22, 93, 255)",textColor:n.isDark?"rgba(255, 255, 255, 0.9)":"rgb(29, 33, 41)",maskColor:n.isDark?"rgba(0, 0, 0, 0.4)":"rgba(255, 255, 255, 0.4)"})),n=J(),a=A();Y([Q,ge,me,K]);const d=i=>{i==="day"?l.range=[g().startOf("day").add(-7,"day").toDate(),new Date]:l.range=[g().startOf("hour").add(-6,"hour").toDate(),new Date]},l=Z({timeStep:"day",range:[g().startOf("day").add(-7,"day").toDate(),new Date]}),v=A({xAxis:{type:"time",max:"dataMax"},yAxis:{type:"value"},tooltip:{trigger:"axis"},series:[{data:[],type:"line",name:e("page.charts.line.options.field")}]});ee(l,i=>{O(i.range[0],i.range[1],i.timeStep)});const{loading:k,run:O,refresh:m}=te(Ye,{defaultParams:[g().startOf("day").add(-7,"day").toDate(),new Date,"day"],onSuccess:i=>{if(i.data){const c=new Map;for(let u=g(l.range[0]);u.isBefore(g(l.range[1]));u=u.add(1,l.timeStep))c.set(u.valueOf(),0);i.data.forEach(u=>{c.set(g(u.timestamp).startOf(l.timeStep).valueOf(),u.count)}),v.value.series[0].data=Array.from(c).sort(([u],[y])=>u-y).map(([u,y])=>[new Date(u),y])}},onError:i=>{a.value=i}});return(i,c)=>{const u=ae,y=Me,b=Ne,C=oe,x=ie,L=se,T=ne,V=N,E=q,B=j;return _(),w(B,{hoverable:"",title:o(e)("page.charts.title.line")},{extra:s(()=>[r(T,null,{content:s(()=>[r(L,{model:l},{default:s(()=>[r(C,{field:"timeStep",label:o(e)("page.charts.options.steps"),"label-col-flex":"100px"},{default:s(()=>[r(b,{modelValue:l.timeStep,"onUpdate:modelValue":c[0]||(c[0]=R=>l.timeStep=R),onChange:c[1]||(c[1]=R=>d(R))},{default:s(()=>[r(y,{value:"day"},{default:s(()=>[f(h(o(e)("page.charts.options.day")),1)]),_:1}),r(y,{value:"hour"},{default:s(()=>[f(h(o(e)("page.charts.options.hour")),1)]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["label"]),r(C,{field:"range",label:o(e)("page.charts.options.days"),"label-col-flex":"100px"},{default:s(()=>[r(x,{"show-time":"",modelValue:l.range,"onUpdate:modelValue":c[2]||(c[2]=R=>l.range=R),"value-format":"Date",shortcuts:l.timeStep==="day"?[{label:o(e)("page.charts.options.shortcut.7days"),value:()=>[o(g)().startOf("day").add(-7,"day").toDate(),new Date]},{label:o(e)("page.charts.options.shortcut.14days"),value:()=>[o(g)().startOf("day").add(-14,"day").toDate(),new Date]},{label:o(e)("page.charts.options.shortcut.30days"),value:()=>[o(g)().startOf("day").add(-30,"day").toDate(),new Date]}]:[{label:o(e)("page.charts.options.shortcut.6hours"),value:()=>[o(g)().startOf("hour").add(-6,"hour").toDate(),new Date]},{label:o(e)("page.charts.options.shortcut.12hours"),value:()=>[o(g)().startOf("hour").add(-12,"hour").toDate(),new Date]},{label:o(e)("page.charts.options.shortcut.24hours"),value:()=>[o(g)().startOf("hour").add(-24,"hour").toDate(),new Date]}]},null,8,["modelValue","shortcuts"])]),_:1},8,["label"])]),_:1},8,["model"])]),default:s(()=>[r(u,null,{default:s(()=>[f(h(o(e)("page.charts.options.more")),1)]),_:1})]),_:1})]),default:s(()=>[a.value?(_(),w(E,{key:0,status:"500",title:o(e)("page.charts.error.title"),class:"chart chart-error"},{subtitle:s(()=>[f(h(a.value.message),1)]),extra:s(()=>[r(V,{type:"primary",onClick:c[3]||(c[3]=()=>{a.value=void 0,o(m)()})},{default:s(()=>[f(h(o(e)("page.charts.error.refresh")),1)]),_:1})]),_:1},8,["title"])):(_(),w(o(H),{key:1,class:"chart",option:v.value,loading:o(k),loadingOptions:t.value,theme:"ovilia-green",autoresize:"","init-options":{renderer:"svg"}},null,8,["option","loading","loadingOptions"]))]),_:1},8,["title"])}}}),Ze=I({__name:"fieldPie",setup(p){const{t:e}=z();Y([Q,he,ve,K]);const t=J(),n=Z({field:"peerId",enableThreshold:!0,mergeSameVersion:!1}),a=P(()=>({text:e("page.charts.loading"),color:t.isDark?"rgb(60, 126, 255)":"rgb(22, 93, 255)",textColor:t.isDark?"rgba(255, 255, 255, 0.9)":"rgb(29, 33, 41)",maskColor:t.isDark?"rgba(0, 0, 0, 0.4)":"rgba(255, 255, 255, 0.4)"})),d=A(),l=A({tooltip:{trigger:"item",appendToBody:!0,formatter:'<p style="word-wrap:break-all"><b>{b}</b></p>  {c} ({d}%)'},legend:{orient:"vertical",left:"right",type:"scroll",right:10,top:20,bottom:20,data:[],textStyle:{overflow:"truncate",width:100},tooltip:{show:!0}},backgroundColor:t.isDark?"rgba(0, 0, 0, 0.0)":void 0,series:[{name:e("page.charts.options.field."+n.field),type:"pie",radius:"55%",center:["50%","60%"],data:[],emphasis:{itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]});ee(n,m=>{k(m.field,m.enableThreshold)});const{loading:v,run:k,refresh:O}=te(Xe,{defaultParams:["peerId",!0],onSuccess:m=>{if(m.data){const i=m.data.map(c=>(c.data===""&&(c.data=e("page.charts.options.field.empty")),c));if(n.mergeSameVersion&&n.field==="peerId"){const c=new Map;i.forEach(u=>{let y=u.data;const b=y.match(/^([-]?[a-zA-z]+)[0-9]+.*/);b&&(b==null?void 0:b.length)>=2&&(y=b[1]+"*"),c.has(y)?c.set(y,c.get(y)+u.count):c.set(y,u.count)}),l.value.legend.data=[],l.value.series[0].data=[],Array.from(c).forEach(([u,y])=>{l.value.legend.data.push(u),l.value.series[0].data.push({name:u,value:y})})}else l.value.legend.data=i.map(c=>c.data),l.value.series[0].data=i.map(c=>({name:c.data,value:c.count}))}},onError:m=>{d.value=m}});return(m,i)=>{const c=N,u=q,y=ae,b=be,C=we,x=oe,L=ke,T=De,V=xe,E=se,B=ne,R=j;return _(),w(R,{hoverable:"",title:o(e)("page.charts.options.field."+n.field)},{extra:s(()=>[r(B,null,{content:s(()=>[r(E,{model:n,style:{width:"25vh"}},{default:s(()=>[r(x,{field:"field",label:o(e)("page.charts.options.field")},{default:s(()=>[r(C,{modelValue:n.field,"onUpdate:modelValue":i[1]||(i[1]=$=>n.field=$),"trigger-props":{autoFitPopupMinWidth:!0}},{default:s(()=>[r(b,{value:"peerId"},{default:s(()=>[f(h(o(e)("page.charts.options.field.peerId")),1)]),_:1}),r(b,{value:"torrentName"},{default:s(()=>[f(h(o(e)("page.charts.options.field.torrentName")),1)]),_:1}),r(b,{value:"module"},{default:s(()=>[f(h(o(e)("page.charts.options.field.module")),1)]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["label"]),r(x,{field:"enableThreshold"},{default:s(()=>[r(V,null,{default:s(()=>[r(L,{modelValue:n.enableThreshold,"onUpdate:modelValue":i[2]||(i[2]=$=>n.enableThreshold=$)},null,8,["modelValue"]),r(T,null,{default:s(()=>[f(h(o(e)("page.charts.options.thresold")),1)]),_:1})]),_:1})]),_:1}),n.field==="peerId"?(_(),w(x,{key:0,field:"mergeSameVersion"},{default:s(()=>[r(V,null,{default:s(()=>[r(L,{modelValue:n.mergeSameVersion,"onUpdate:modelValue":i[3]||(i[3]=$=>n.mergeSameVersion=$)},null,8,["modelValue"]),r(T,null,{default:s(()=>[f(h(o(e)("page.charts.options.mergeSame")),1)]),_:1})]),_:1})]),_:1})):Le("",!0)]),_:1},8,["model"])]),default:s(()=>[r(y,null,{default:s(()=>[f(h(o(e)("page.charts.options.more")),1)]),_:1})]),_:1})]),default:s(()=>[d.value?(_(),w(u,{key:0,status:"500",title:o(e)("page.charts.error.title"),class:"chart chart-error"},{subtitle:s(()=>[f(h(d.value.message),1)]),extra:s(()=>[r(c,{type:"primary",onClick:i[0]||(i[0]=()=>{d.value=void 0,o(O)()})},{default:s(()=>[f(h(o(e)("page.charts.error.refresh")),1)]),_:1})]),_:1},8,["title"])):(_(),w(o(H),{key:1,class:"chart",option:l.value,loading:o(v),autoresize:"",loadingOptions:a.value,theme:o(t).isDark?"dark":"light","init-options":{renderer:"svg"}},null,8,["option","loading","loadingOptions","theme"]))]),_:1},8,["title"])}}}),et=I({__name:"trends",setup(p){Y([me,Q,ge,K]);const{t:e}=z(),t=Z({range:[g().startOf("day").add(-7,"day").toDate(),new Date]}),n=A(),a=J(),d=P(()=>({text:e("page.charts.loading"),color:a.isDark?"rgb(60, 126, 255)":"rgb(22, 93, 255)",textColor:a.isDark?"rgba(255, 255, 255, 0.9)":"rgb(29, 33, 41)",maskColor:a.isDark?"rgba(0, 0, 0, 0.4)":"rgba(255, 255, 255, 0.4)"})),l=A({xAxis:{type:"time",max:"dataMax"},yAxis:{type:"value"},tooltip:{trigger:"axis"},series:[{data:[],type:"line",color:"#A5A051",areaStyle:{color:"#A5A051"},name:e("page.charts.trends.options.peers")},{data:[],type:"line",color:"#DB4D6D",areaStyle:{color:"#DB4D6D"},name:e("page.charts.trends.options.bans")}]});ee(t,m=>{k(m.range[0],m.range[1])});const{loading:v,run:k,refresh:O}=te(He,{defaultParams:[g().startOf("day").add(-7,"day").toDate(),new Date],onSuccess:m=>{m.data&&(l.value.series[0].data=m.data.connectedPeersTrend.sort((i,c)=>i.key-c.key).map(i=>[new Date(i.key),i.value]),l.value.series[1].data=m.data.bannedPeersTrend.sort((i,c)=>i.key-c.key).map(i=>[new Date(i.key),i.value]))},onError:m=>{n.value=m}});return(m,i)=>{const c=ae,u=ie,y=oe,b=se,C=ne,x=N,L=q,T=j;return _(),w(T,{hoverable:"",title:o(e)("page.charts.title.trends")},{extra:s(()=>[r(C,null,{content:s(()=>[r(b,{model:t},{default:s(()=>[r(y,{field:"range",label:o(e)("page.charts.options.days"),"label-col-flex":"100px"},{default:s(()=>[r(u,{"show-time":"",modelValue:t.range,"onUpdate:modelValue":i[0]||(i[0]=V=>t.range=V),"value-format":"Date",shortcuts:[{label:o(e)("page.charts.options.shortcut.7days"),value:()=>[o(g)().startOf("day").add(-7,"day").toDate(),new Date]},{label:o(e)("page.charts.options.shortcut.14days"),value:()=>[o(g)().startOf("day").add(-14,"day").toDate(),new Date]},{label:o(e)("page.charts.options.shortcut.30days"),value:()=>[o(g)().startOf("day").add(-30,"day").toDate(),new Date]}]},null,8,["modelValue","shortcuts"])]),_:1},8,["label"])]),_:1},8,["model"])]),default:s(()=>[r(c,null,{default:s(()=>[f(h(o(e)("page.charts.options.more")),1)]),_:1})]),_:1})]),default:s(()=>[n.value?(_(),w(L,{key:0,status:"500",title:o(e)("page.charts.error.title"),class:"chart chart-error"},{subtitle:s(()=>[f(h(n.value.message),1)]),extra:s(()=>[r(x,{type:"primary",onClick:i[1]||(i[1]=()=>{n.value=void 0,o(O)()})},{default:s(()=>[f(h(o(e)("page.charts.error.refresh")),1)]),_:1})]),_:1},8,["title"])):(_(),w(o(H),{key:1,class:"chart",option:l.value,loading:o(v),loadingOptions:d.value,theme:"ovilia-green",autoresize:"","init-options":{renderer:"svg"}},null,8,["option","loading","loadingOptions"]))]),_:1},8,["title"])}}}),tt=I({__name:"traffic",setup(p){Y([Q,he,Ae,me,Ie,K]);const e=Z({range:[g().startOf("day").add(-7,"day").toDate(),new Date]}),t=J(),n=P(()=>({text:a("page.charts.loading"),color:t.isDark?"rgb(60, 126, 255)":"rgb(22, 93, 255)",textColor:t.isDark?"rgba(255, 255, 255, 0.9)":"rgb(29, 33, 41)",maskColor:t.isDark?"rgba(0, 0, 0, 0.4)":"rgba(255, 255, 255, 0.4)"})),{t:a,d}=z(),l=A(),v=A({tooltip:{trigger:"axis",axisPointer:{type:"shadow"},formatter:function(i){var c;return((c=i[0])==null?void 0:c.name)+":<br/>"+i.map(u=>`${u.marker} ${u.seriesName}: ${fe(u.value)}`).join("<br>")}},legend:{data:[a("page.charts.traffic.options.download"),a("page.charts.traffic.options.upload")]},xAxis:[{type:"category",axisTick:{show:!1},data:[]}],yAxis:[{type:"value",axisLabel:{formatter:i=>fe(i)}}],series:[{name:a("page.charts.traffic.options.download"),type:"bar",barGap:0,emphasis:{focus:"series"},data:[]},{name:a("page.charts.traffic.options.upload"),type:"bar",emphasis:{focus:"series"},data:[]}]});ee(e,i=>{O(i.range[0],i.range[1])});const{loading:k,run:O,refresh:m}=te(Qe,{defaultParams:[g().startOf("day").add(-7,"day").toDate(),new Date],onSuccess:i=>{i.data&&(v.value.xAxis[0].data.splice(0),v.value.series[0].data.splice(0),v.value.series[1].data.splice(0),i.data.journal.forEach(c=>{v.value.xAxis[0].data.push(d(new Date(c.timestamp),"short")),v.value.series[0].data.push(c.downloaded),v.value.series[1].data.push(c.uploaded)}))},onError:i=>{l.value=i}});return(i,c)=>{const u=ae,y=ie,b=oe,C=se,x=Se,L=Oe,T=ne,V=N,E=q,B=j;return _(),w(B,{hoverable:"",title:o(a)("page.charts.title.traffic")},{extra:s(()=>[r(T,null,{content:s(()=>[r(C,{model:e},{default:s(()=>[r(b,{field:"range",label:o(a)("page.charts.options.days"),"label-col-flex":"100px"},{default:s(()=>[r(y,{"show-time":"",modelValue:e.range,"onUpdate:modelValue":c[0]||(c[0]=R=>e.range=R),"value-format":"Date",shortcuts:[{label:o(a)("page.charts.options.shortcut.7days"),value:()=>[o(g)().startOf("day").add(-7,"day").toDate(),new Date]},{label:o(a)("page.charts.options.shortcut.14days"),value:()=>[o(g)().startOf("day").add(-14,"day").toDate(),new Date]},{label:o(a)("page.charts.options.shortcut.30days"),value:()=>[o(g)().startOf("day").add(-30,"day").toDate(),new Date]}]},null,8,["modelValue","shortcuts"])]),_:1},8,["label"])]),_:1},8,["model"])]),default:s(()=>[r(u,null,{default:s(()=>[f(h(o(a)("page.charts.options.more")),1)]),_:1}),r(L,{content:o(a)("page.charts.tooltip.traffic")},{default:s(()=>[r(x)]),_:1},8,["content"])]),_:1})]),default:s(()=>[l.value?(_(),w(E,{key:0,status:"500",title:o(a)("page.charts.error.title"),class:"chart chart-error"},{subtitle:s(()=>[f(h(l.value.message),1)]),extra:s(()=>[r(V,{type:"primary",onClick:c[1]||(c[1]=()=>{l.value=void 0,o(m)()})},{default:s(()=>[f(h(o(a)("page.charts.error.refresh")),1)]),_:1})]),_:1},8,["title"])):(_(),w(o(H),{key:1,class:"chart",option:v.value,loading:o(k),loadingOptions:n.value,theme:"ovilia-green",autoresize:"","init-options":{renderer:"svg"}},null,8,["option","loading","loadingOptions"]))]),_:1},8,["title"])}}}),at=I({__name:"plusWarpper",props:{title:{}},setup(p){const e=Ee(()=>Ve(()=>import("./dummyChart-DaUIKEy4.js"),__vite__mapDeps([0,1,2,3,4,5]),import.meta.url)),{t}=z(),n=M(),a=P(()=>n.plusStatus),d=()=>{n.emmitter.emit("open-plus-modal")};return(l,v)=>{var c;const k=Ge,O=N,m=q,i=j;return(c=a.value)!=null&&c.activated?Pe(l.$slots,"default",{key:0},void 0,!0):(_(),w(i,{key:1,hoverable:"",title:l.title},{default:s(()=>[r(m,{class:"overlay",status:"warning",title:o(t)("page.charts.locked")},{icon:s(()=>[r(k)]),subtitle:s(()=>[f(h(o(t)("page.charts.locked.tips")),1)]),extra:s(()=>[r(O,{type:"primary",onClick:d},{default:s(()=>[f(h(o(t)("page.charts.locked.active")),1)]),_:1})]),_:1},8,["title"]),r(o(e))]),_:1},8,["title"]))}}}),ue=Re(at,[["__scopeId","data-v-fa9c84e8"]]);var ot=Object.defineProperty,st=(p,e,t)=>e in p?ot(p,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):p[e]=t,D=(p,e,t)=>st(p,typeof e!="symbol"?e+"":e,t);const re=(p,e)=>{const t=p.__vccOpts||p;for(const[n,a]of e)t[n]=a;return t},nt={},rt={class:"cell"};function lt(p,e){return _(),U("span",rt,h(""))}const it=re(nt,[["render",lt],["__scopeId","data-v-511ca080"]]),dt=I({__name:"TileView",props:{tile:{}},setup(p){const e=p,{tile:t}=ye(e),n=P(()=>{var a=["tile"];return a.push("tile"+t.value.value),t.value.mergedInto||a.push("position_"+t.value.row+"_"+t.value.column),t.value.mergedInto&&a.push("merged"),t.value.isNew()&&a.push("new"),t.value.hasMoved()&&(a.push("row_from_"+t.value.fromRow()+"_to_"+t.value.toRow()),a.push("column_from_"+t.value.fromColumn()+"_to_"+t.value.toColumn()),a.push("isMoving")),a.join(" ")});return(a,d)=>(_(),U("span",{class:$e(n.value)},h(o(t).value),3))}}),ct=re(dt,[["__scopeId","data-v-fa56f5f8"]]),ut={class:"overlay"},pt={class:"message"},mt=I({__name:"GameEndOverlay",props:{board:{},onrestart:{type:Function}},setup(p){const e=p,{board:t}=ye(e),n=P(()=>t.value.hasWon()||t.value.hasLost()),a=P(()=>t.value.hasWon()?"Good Job!":t.value.hasLost()?"Game Over":""),d=()=>{e.onrestart&&e.onrestart()};return(l,v)=>Fe((_(),U("div",ut,[pe("p",pt,h(a.value),1),pe("button",{class:"tryAgain",onClick:d},"Try again")],512)),[[je,n.value]])}}),ht=re(mt,[["__scopeId","data-v-4b39d1e3"]]),Ce=class Te{constructor(e,t,n){D(this,"value"),D(this,"row"),D(this,"column"),D(this,"oldRow"),D(this,"oldColumn"),D(this,"markForDeletion"),D(this,"mergedInto"),D(this,"id"),this.value=e||0,this.row=t||-1,this.column=n||-1,this.oldRow=-1,this.oldColumn=-1,this.markForDeletion=!1,this.mergedInto=null,this.id=Te.id++}moveTo(e,t){this.oldRow=this.row,this.oldColumn=this.column,this.row=e,this.column=t}isNew(){return this.oldRow===-1&&!this.mergedInto}hasMoved(){return this.fromRow()!==-1&&(this.fromRow()!==this.toRow()||this.fromColumn()!==this.toColumn())||this.mergedInto!==null}fromRow(){return this.mergedInto?this.row:this.oldRow}fromColumn(){return this.mergedInto?this.column:this.oldColumn}toRow(){return this.mergedInto?this.mergedInto.row:this.row}toColumn(){return this.mergedInto?this.mergedInto.column:this.column}};D(Ce,"id",0);let ft=Ce;const W=class S{constructor(){D(this,"tiles"),D(this,"cells"),D(this,"won"),this.tiles=[],this.cells=[];for(let e=0;e<S.size;++e)this.cells[e]=[this.addTile(),this.addTile(),this.addTile(),this.addTile()];this.addRandomTile(),this.setPositions(),this.won=!1}addTile(e){const t=new ft(e);return this.tiles.push(t),t}moveLeft(){let e=!1;for(let t=0;t<S.size;++t){const n=this.cells[t].filter(d=>d.value!=0),a=[];for(let d=0;d<S.size;++d){let l=n.length>0?n.shift():this.addTile();if(n.length>0&&n[0].value===l.value){const v=l;l=this.addTile(l.value),v.mergedInto=l;const k=n.shift();k.mergedInto=l,l.value+=k.value}a[d]=l,this.won=this.won||l.value===2048,e=e||l.value!==this.cells[t][d].value}this.cells[t]=a}return e}setPositions(){this.cells.forEach((e,t)=>{e.forEach((n,a)=>{n.oldRow=n.row,n.oldColumn=n.column,n.row=t,n.column=a,n.markForDeletion=!1})})}addRandomTile(){const e=[];for(let d=0;d<S.size;++d)for(let l=0;l<S.size;++l)this.cells[d][l].value===0&&e.push({r:d,c:l});const t=Math.floor(Math.random()*e.length),n=e[t],a=Math.random()<S.fourProbability?4:2;this.cells[n.r][n.c]=this.addTile(a)}move(e){this.clearOldTiles();for(let n=0;n<e;++n)this.cells=this.rotateLeft(this.cells);const t=this.moveLeft();for(let n=e;n<4;++n)this.cells=this.rotateLeft(this.cells);return t&&this.addRandomTile(),this.setPositions(),this}clearOldTiles(){this.tiles=this.tiles.filter(e=>!e.markForDeletion),this.tiles.forEach(e=>e.markForDeletion=!0)}hasWon(){return this.won}hasLost(){let e=!1;for(let t=0;t<S.size;++t)for(let n=0;n<S.size;++n){e=e||this.cells[t][n].value===0;for(let a=0;a<4;++a){const d=t+S.deltaX[a],l=n+S.deltaY[a];d<0||d>=S.size||l<0||l>=S.size||(e=e||this.cells[t][n].value===this.cells[d][l].value)}}return!e}rotateLeft(e){const t=e.length,n=e[0].length,a=[];for(let d=0;d<t;++d){a.push([]);for(let l=0;l<n;++l)a[d][l]=e[l][n-d-1]}return a}};D(W,"size",4),D(W,"fourProbability",.1),D(W,"deltaX",[-1,0,1,0]),D(W,"deltaY",[0,-1,0,1]);let _e=W;const _t={class:"board",tabIndex:"1"},gt=I({__name:"BoardView",setup(p){const e=A(new _e),t=d=>{if(!e.value.hasWon()&&d.keyCode>=37&&d.keyCode<=40){d.preventDefault();var l=d.keyCode-37;e.value.move(l)}},n=()=>{e.value=new _e};ze(()=>{window.addEventListener("keydown",t)}),Be(()=>{window.removeEventListener("keydown",t)});const a=P(()=>e.value.tiles.filter(d=>d.value!=0));return(d,l)=>(_(),U("div",_t,[(_(!0),U(de,null,ce(e.value.cells,(v,k)=>(_(),U("div",{key:k},[(_(!0),U(de,null,ce(v,(O,m)=>(_(),w(it,{key:m}))),128))]))),128)),(_(!0),U(de,null,ce(a.value,(v,k)=>(_(),w(ct,{tile:v,key:k},null,8,["tile"]))),128)),r(ht,{board:e.value,onrestart:n},null,8,["board"])]))}}),vt=re(gt,[["__scopeId","data-v-dd29ef2e"]]),yt={name:"vue-2048",components:{BoardView:vt}};function bt(p,e,t,n,a,d){const l=Ue("BoardView");return _(),w(l,{style:{margin:"0 auto"}})}const le=re(yt,[["render",bt]]),wt=p=>{p.component(le.name,le)};le.install=wt;const kt={class:"chart"},Dt=I({__name:"2048",setup(p){const{t:e}=z();return(t,n)=>{const a=Se,d=Oe,l=j;return _(),w(l,{hoverable:"",title:"2048"},{extra:s(()=>[r(d,{content:o(e)("page.charts.tooltip.2048")},{default:s(()=>[r(a)]),_:1},8,["content"])]),default:s(()=>[pe("div",kt,[r(o(le),{style:{margin:"0 auto"}})])]),_:1})}}}),xt=I({__name:"ispPie",setup(p){const{t:e}=z();Y([Q,he,ve,K]);const t=J(),n=A(),a=Z({field:"isp",enableThreshold:!0,bannedOnly:!0,range:[g().startOf("day").add(-7,"day").toDate(),new Date]}),d=P(()=>({text:e("page.charts.loading"),color:t.isDark?"rgb(60, 126, 255)":"rgb(22, 93, 255)",textColor:t.isDark?"rgba(255, 255, 255, 0.9)":"rgb(29, 33, 41)",maskColor:t.isDark?"rgba(0, 0, 0, 0.4)":"rgba(255, 255, 255, 0.4)"})),l=A({tooltip:{trigger:"item",appendToBody:!0,formatter:'<p style="word-wrap:break-all"><b>{b}</b></p>  {c} ({d}%)'},legend:{orient:"vertical",left:"right",type:"scroll",right:10,top:20,bottom:20,data:[],textStyle:{overflow:"truncate",width:100},tooltip:{show:!0}},backgroundColor:t.isDark?"rgba(0, 0, 0, 0.0)":void 0,series:[{name:"",type:"pie",radius:"55%",center:["50%","60%"],data:[],emphasis:{itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]});ee(a,m=>{k(m.range[0],m.range[1],a.bannedOnly)});const{loading:v,run:k,refresh:O}=te(Je,{defaultParams:[g().startOf("day").add(-7,"day").toDate(),new Date,a.bannedOnly],onSuccess:m=>{if(m.data){const i=m.data[a.field];let c;if(a.enableThreshold){const y=i.reduce((b,C)=>b+C.value,0)*.01;c=i.filter(b=>b.value>=y)}else c=i;l.value.legend.data=c.map(u=>u.key),l.value.series[0].data=c.map(u=>({name:u.key==="N/A"&&a.field==="province"?e("page.charts.data.province.na"):u.key,value:u.value})),l.value.series[0].name=e("page.charts.options.field."+a.field)}},onError:m=>{n.value=m}});return(m,i)=>{const c=N,u=q,y=ae,b=be,C=we,x=oe,L=ie,T=ke,V=De,E=xe,B=se,R=ne,$=j;return _(),w($,{hoverable:"",title:o(e)("page.charts.title.geoip")+(a.bannedOnly?o(e)("page.charts.subtitle.bannedOnly"):"")},{extra:s(()=>[r(R,null,{content:s(()=>[r(B,{model:a},{default:s(()=>[r(x,{field:"field",label:o(e)("page.charts.options.field")},{default:s(()=>[r(C,{modelValue:a.field,"onUpdate:modelValue":i[1]||(i[1]=F=>a.field=F),"trigger-props":{autoFitPopupMinWidth:!0}},{default:s(()=>[r(b,{value:"isp"},{default:s(()=>[f(h(o(e)("page.charts.options.field.isp")),1)]),_:1}),r(b,{value:"province"},{default:s(()=>[f(h(o(e)("page.charts.options.field.province")),1)]),_:1}),r(b,{value:"city"},{default:s(()=>[f(h(o(e)("page.charts.options.field.city")),1)]),_:1}),r(b,{value:"region"},{default:s(()=>[f(h(o(e)("page.charts.options.field.region")),1)]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["label"]),r(x,{field:"range",label:o(e)("page.charts.options.days"),"label-col-flex":"100px"},{default:s(()=>[r(L,{"show-time":"",modelValue:a.range,"onUpdate:modelValue":i[2]||(i[2]=F=>a.range=F),"value-format":"Date",shortcuts:[{label:o(e)("page.charts.options.shortcut.7days"),value:()=>[o(g)().startOf("day").add(-7,"day").toDate(),new Date]},{label:o(e)("page.charts.options.shortcut.14days"),value:()=>[o(g)().startOf("day").add(-14,"day").toDate(),new Date]},{label:o(e)("page.charts.options.shortcut.30days"),value:()=>[o(g)().startOf("day").add(-30,"day").toDate(),new Date]}]},null,8,["modelValue","shortcuts"])]),_:1},8,["label"]),r(x,{field:"enableThreshold"},{default:s(()=>[r(E,null,{default:s(()=>[r(T,{modelValue:a.enableThreshold,"onUpdate:modelValue":i[3]||(i[3]=F=>a.enableThreshold=F)},null,8,["modelValue"]),r(V,null,{default:s(()=>[f(h(o(e)("page.charts.options.thresold")),1)]),_:1})]),_:1})]),_:1}),r(x,{field:"bannedOnly"},{default:s(()=>[r(E,null,{default:s(()=>[r(T,{modelValue:a.bannedOnly,"onUpdate:modelValue":i[4]||(i[4]=F=>a.bannedOnly=F)},null,8,["modelValue"]),r(V,null,{default:s(()=>[f(h(o(e)("page.charts.options.bannedOnly")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),default:s(()=>[r(y,null,{default:s(()=>[f(h(o(e)("page.charts.options.more")),1)]),_:1})]),_:1})]),default:s(()=>[n.value?(_(),w(u,{key:0,status:"500",title:o(e)("page.charts.error.title"),class:"chart chart-error"},{subtitle:s(()=>[f(h(n.value.message),1)]),extra:s(()=>[r(c,{type:"primary",onClick:i[0]||(i[0]=()=>{n.value=void 0,o(O)()})},{default:s(()=>[f(h(o(e)("page.charts.error.refresh")),1)]),_:1})]),_:1},8,["title"])):(_(),w(o(H),{key:1,class:"chart",option:l.value,loading:o(v),autoresize:"",loadingOptions:d.value,theme:o(t).isDark?"dark":"light","init-options":{renderer:"svg"}},null,8,["option","loading","loadingOptions","theme"]))]),_:1},8,["title"])}}}),Rt=I({__name:"index",setup(p){const{t:e}=z();return(t,n)=>{const a=We,d=qe;return _(),w(d,{justify:"center",align:"stretch",wrap:!0,gutter:[{xs:12,sm:12,md:12,lg:12,xl:24},{xs:12,sm:12,md:12,lg:12,xl:24}]},{default:s(()=>[r(a,{xl:12,lg:24,md:24,sm:24,xs:24},{default:s(()=>[r(Ke)]),_:1}),r(a,{xl:12,lg:24,md:24,sm:24,xs:24},{default:s(()=>[r(Ze)]),_:1}),r(a,{xl:12,lg:24,md:24,sm:24,xs:24},{default:s(()=>[r(ue,{title:o(e)("page.charts.title.trends")},{default:s(()=>[r(et)]),_:1},8,["title"])]),_:1}),r(a,{xl:12,lg:24,md:24,sm:24,xs:24},{default:s(()=>[r(ue,{title:o(e)("page.charts.title.traffic")},{default:s(()=>[r(tt)]),_:1},8,["title"])]),_:1}),r(a,{xl:12,lg:24,md:24,sm:24,xs:24},{default:s(()=>[r(ue,{title:o(e)("page.charts.title.geoip")},{default:s(()=>[r(xt)]),_:1},8,["title"])]),_:1}),r(a,{xl:12,lg:24,md:24,sm:24,xs:24},{default:s(()=>[r(Dt)]),_:1})]),_:1})}}});export{Rt as default};
