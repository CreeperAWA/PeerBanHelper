import{u as ne,h as xe,c as X,f as z,I as oe,b as le,_ as se,j as Ue}from"./index-Hm67rr0_.js";import{f as ie,a6 as ce,a9 as Ce,a2 as e,j as c,s as p,t,y as a,v as l,x as s,p as $,k as ee,P as Ne,F as He,u as b,a1 as ae,w as Ge,c as $e,r as Re,a8 as qe,af as Me,o as Oe,M as Qe,N as Je,E as Pe}from"./libs-Bsjl4Mfh.js";import{c as We,d as Xe,e as Ye}from"./data-BNkioh_J.js";import{a4 as Ae,S as te,b as De,c as re,T as pe,o as Fe,E as Ze,ak as et,Q as tt,y as at,w as nt,j as ot,D as lt,L as st,B as it,h as ct,U as rt,al as pt,am as dt,x as ut,ag as _t,H as gt}from"./arcoDesign-Dk7yFUDg.js";import{I as ft}from"./index-CvBtp9Cy.js";import{I as mt}from"./index-BU-uc78i.js";const bt=ie({__name:"accessHistoryTable",props:{ip:{}},setup(Y){const{t:d,d:o}=ce(),N=ne(),{data:n,total:K,current:A,loading:w,pageSize:V,changeCurrent:v,changePageSize:D}=Ce(We,{defaultParams:[{ip:Y.ip,page:1,pageSize:5}],pagination:{currentKey:"page",pageSizeKey:"pageSize",totalKey:"data.total"},cacheKey:m=>`${N.endpoint}-ipAccessHistory-${m==null?void 0:m[0].ip}-${(m==null?void 0:m[0].page)||1}-${(m==null?void 0:m[0].pageSize)||10}`}),Z=[{title:"ID",dataIndex:"id"},{title:()=>d("page.torrentList.accessHistory.column.downloader"),slotName:"downloader"},{title:"Peer ID",slotName:"peerId"},{title:()=>d("page.torrentList.accessHistory.column.traffic"),slotName:"traffic"},{title:()=>ae(te,[d("page.torrentList.accessHistory.column.offset"),ae(Ae,{content:d("page.torrentList.accessHistory.column.offsetDescription")},()=>ae(X))]),slotName:"offset"},{title:"Flags",slotName:"flags"},{title:()=>d("page.torrentList.accessHistory.column.timeseen"),slotName:"time"}],g=m=>m.split(" ").map(_=>_+" - "+d("page.dashboard.peerList.column.flags."+_.trim()));return(m,_)=>{var T,B;const j=De,F=re,S=oe,y=pe,h=le,f=te,E=Fe,U=Ze;return(T=e(n))!=null&&T.data.results||e(w)?(c(),p(E,{key:0,stripe:!0,columns:Z,data:(B=e(n))==null?void 0:B.data.results,loading:e(w),pagination:{total:e(K),current:e(A),pageSize:e(V),showPageSize:!0,baseSize:4,bufferSize:1},"column-resizable":"",size:"medium",class:"banlog-table",onPageChange:e(v),onPageSizeChange:e(D)},{downloader:t(({record:r})=>[a(j,{color:e(xe)(r.downloader)},{default:t(()=>[l(s(r.downloader),1)]),_:2},1032,["color"])]),peerId:t(({record:r})=>[$("p",null,[l(s(r.peerId?r.peerId:e(d)("page.banlist.banlist.listItem.empty"))+" ",1),a(F,{content:r.clientName?r.clientName:e(d)("page.banlist.banlist.listItem.empty")},{default:t(()=>[a(e(X))]),_:2},1032,["content"])])]),traffic:t(({record:r})=>[a(f,{fill:"",direction:"vertical"},{default:t(()=>[a(y,null,{default:t(()=>[a(S,{class:"green"}),l(" "+s(e(z)(r.uploaded)),1)]),_:2},1024),a(y,null,{default:t(()=>[a(h,{class:"red"}),l(" "+s(e(z)(r.downloaded)),1)]),_:2},1024)]),_:2},1024)]),offset:t(({record:r})=>[a(f,{fill:"",direction:"vertical"},{default:t(()=>[a(y,null,{default:t(()=>[a(S,{class:"green"}),l(" "+s(e(z)(r.uploadedOffset)),1)]),_:2},1024),a(y,null,{default:t(()=>[a(h,{class:"red"}),l(" "+s(e(z)(r.downloadedOffset)),1)]),_:2},1024)]),_:2},1024)]),flags:t(({record:r})=>[$("p",null,[l(s(r.lastFlags)+" ",1),r.lastFlags?(c(),p(F,{key:0},{content:t(()=>[(c(!0),ee(He,null,Ne(g(r.lastFlags),u=>(c(),ee("p",{key:u},s(u),1))),128))]),default:t(()=>[a(e(X))]),_:2},1024)):b("",!0)])]),time:t(({record:r})=>[a(f,{fill:"",direction:"vertical"},{default:t(()=>[a(y,null,{default:t(()=>[l(s(e(d)("page.torrentList.accessHistory.column.timeseen.first"))+": "+s(e(o)(r.firstTimeSeen,"long")),1)]),_:2},1024),a(y,null,{default:t(()=>[l(s(e(d)("page.torrentList.accessHistory.column.timeseen.last"))+": "+s(e(o)(r.lastTimeSeen,"long")),1)]),_:2},1024)]),_:2},1024)]),_:1},8,["data","loading","pagination","onPageChange","onPageSizeChange"])):(c(),p(U,{key:1,style:{height:"20vh","align-items":"center",display:"flex","justify-content":"center","flex-direction":"column"}},{default:t(()=>[l(s(e(d)("page.torrentList.accessHistory.empty")),1)]),_:1}))}}}),yt=se(bt,[["__scopeId","data-v-eb19a4ad"]]),ht=ie({__name:"banHistoryTable",props:{ip:{}},setup(Y){const d=ne(),{t:o,d:N}=ce(),{data:n,total:K,current:A,loading:w,pageSize:V,changeCurrent:v,changePageSize:D,refresh:Z}=Ce(Xe,{defaultParams:[{ip:Y.ip,page:1,pageSize:10}],pagination:{currentKey:"page",pageSizeKey:"pageSize",totalKey:"data.total"},cacheKey:_=>`${d.endpoint}-banlogs-${(_==null?void 0:_[0].page)||1}-${(_==null?void 0:_[0].pageSize)||10}`});Ge(()=>d.endpoint,Z);const g=[{title:()=>o("page.banlog.banlogTable.column.banTime")+"/"+o("page.banlog.banlogTable.column.unbanTime"),slotName:"banAt",width:210},{title:()=>o("page.banlog.banlogTable.column.peerPort"),dataIndex:"peerPort",width:80},{title:()=>o("page.banlog.banlogTable.column.peerId"),slotName:"peerId",width:120},{title:()=>o("page.banlog.banlogTable.column.trafficSnapshot"),slotName:"peerStatus",width:150},{title:()=>o("page.banlog.banlogTable.column.torrentName"),dataIndex:"torrentName",ellipsis:!0,tooltip:!0},{title:()=>o("page.banlog.banlogTable.column.torrentSize"),slotName:"torrentSize",width:120},{title:()=>o("page.banlog.banlogTable.column.description"),dataIndex:"description",ellipsis:!0,tooltip:!0}],m=$e(()=>{var _;return(_=n.value)==null?void 0:_.data.results});return(_,j)=>{const F=ft,S=pe,y=et,h=te,f=oe,E=le,U=tt,T=re,B=X,r=Fe;return c(),p(r,{stripe:!0,columns:g,data:m.value,loading:e(w),pagination:{total:e(K),current:e(A),pageSize:e(V),showPageSize:!0,baseSize:4,bufferSize:1},"column-resizable":"",size:"medium",class:"banlog-table",onPageChange:e(v),onPageSizeChange:e(D)},{banAt:t(({record:u})=>[a(h,{fill:"",direction:"vertical"},{default:t(()=>[a(S,null,{default:t(()=>[a(F),l(" "+s(e(N)(u.banAt,"long")),1)]),_:2},1024),a(S,null,{default:t(()=>[a(y),l(" "+s(u.unbanAt?e(N)(u.unbanAt,"long"):e(o)("page.banlog.banlogTable.notUnbanned")),1)]),_:2},1024)]),_:2},1024)]),peerStatus:t(({record:u})=>[a(h,{fill:"",style:{"justify-content":"space-between"}},{default:t(()=>[a(h,{fill:"",direction:"vertical"},{default:t(()=>[a(S,null,{default:t(()=>[a(f,{class:"green"}),l(" "+s(e(z)(u.peerUploaded)),1)]),_:2},1024),a(S,null,{default:t(()=>[a(E,{class:"red"}),l(" "+s(e(z)(u.peerDownloaded)),1)]),_:2},1024)]),_:2},1024),a(T,{content:(u.peerProgress*100).toFixed(2)+"%"},{default:t(()=>[a(U,{percent:u.peerProgress,size:"mini"},null,8,["percent"])]),_:2},1032,["content"])]),_:2},1024)]),peerId:t(({record:u})=>[$("p",null,[l(s(u.peerId?u.peerId:e(o)("page.banlist.banlist.listItem.empty"))+" ",1),a(T,{content:u.peerClientName?u.peerClientName:e(o)("page.banlist.banlist.listItem.empty")},{default:t(()=>[a(B)]),_:2},1032,["content"])])]),torrentSize:t(({record:u})=>[a(T,{content:`Hash: ${u.torrentInfoHash}`},{default:t(()=>[$("p",null,s(e(z)(u.torrentSize)),1)]),_:2},1032,["content"])]),_:1},8,["data","loading","pagination","onPageChange","onPageSizeChange"])}}}),St=se(ht,[["__scopeId","data-v-733c65d5"]]),kt={class:"center searchContainer"},It={class:"result-container center"},vt=ie({__name:"index",setup(Y){const d=Re(""),{t:o,d:N}=ce(),{data:n,loading:K,run:A,error:w}=qe(Ye,{manual:!0}),V=ne(),v=$e(()=>V.plusStatus),{query:D}=Me();return Oe(()=>{D.ip&&(d.value=D.ip,A(d.value))}),(Z,g)=>{const m=at,_=pe,j=nt,F=ot,S=De,y=Ae,h=te,f=lt,E=oe,U=le,T=X,B=st,r=re,u=it,Be=ct,de=rt,ue=mt,_e=pt,Ke=dt,Ve=ut,je=_t,Ee=gt;return c(),p(h,{direction:"vertical",fill:"",class:"center"},{default:t(()=>{var ge;return[a(j,{style:{"text-align":"center"}},{default:t(()=>[a(m,null,{default:t(()=>[l(s(e(o)("page.ipList.title")),1)]),_:1}),a(_,null,{default:t(()=>[l(s(e(o)("page.ipList.description")),1)]),_:1})]),_:1}),$("div",kt,[a(F,{modelValue:d.value,"onUpdate:modelValue":g[0]||(g[0]=H=>d.value=H),"search-button":"",placeholder:"192.168.1.1....",class:"searchBox",loading:e(K),onSearch:e(A)},null,8,["modelValue","loading","onSearch"])]),$("div",It,[Qe(a(Ee,{class:"result-card",hoverable:""},{default:t(()=>[e(w)?(c(),p(je,{key:1,status:"500",title:e(o)("page.ipList.error"),subtitle:e(w).message},{default:t(()=>[a(j,{style:{background:"var(--color-fill-2)",padding:"24px"}},{default:t(()=>{var H;return[a(Ve,null,{default:t(()=>g[6]||(g[6]=[l("Details:")])),_:1}),$("ul",null,[(c(!0),ee(He,null,Ne((H=e(w).stack)==null?void 0:H.split(`
`),k=>(c(),ee("li",{key:k},s(k),1))),128))])]}),_:1})]),_:1},8,["title","subtitle"])):(c(),p(h,{key:0,direction:"vertical",fill:""},{default:t(()=>{var H;return[a(Be,null,{title:t(()=>[a(h,null,{default:t(()=>{var k,L;return[l(s((k=e(n))==null?void 0:k.data.address)+" ",1),(L=e(n))!=null&&L.data.found?b("",!0):(c(),p(y,{key:0,content:e(o)("page.ipList.notfound.tips")},{default:t(()=>[a(S,null,{default:t(()=>g[1]||(g[1]=[l("Not found")])),_:1})]),_:1},8,["content"]))]}),_:1})]),default:t(()=>{var k,L,G,R,P,fe,me,be,ye,he,Se,ke,Ie,ve,we,Te,ze,Le;return[(k=e(n))!=null&&k.data.found?(c(),p(f,{key:0,label:e(o)("page.ipList.label.banCount"),span:2},{default:t(()=>{var i;return[l(s((i=e(n))==null?void 0:i.data.banCount),1)]}),_:1},8,["label"])):b("",!0),(L=e(n))!=null&&L.data.found?(c(),p(f,{key:1,label:e(o)("page.ipList.label.torrentAccessCount"),span:2},{default:t(()=>{var i;return[l(s((i=e(n))==null?void 0:i.data.torrentAccessCount),1)]}),_:1},8,["label"])):b("",!0),(G=e(n))!=null&&G.data.found?(c(),p(f,{key:2,label:e(o)("page.ipList.label.uploadedToPeer"),span:2},{default:t(()=>[a(_,null,{default:t(()=>{var i;return[a(E,{class:"green"}),l(" "+s(e(z)(((i=e(n))==null?void 0:i.data.uploadedToPeer)??0)),1)]}),_:1})]),_:1},8,["label"])):b("",!0),(R=e(n))!=null&&R.data.found?(c(),p(f,{key:3,label:e(o)("page.ipList.label.downloadedFromPeer"),span:2},{default:t(()=>[a(_,null,{default:t(()=>{var i;return[a(U,{class:"red"}),l(" "+s(e(z)(((i=e(n))==null?void 0:i.data.downloadedFromPeer)??0)),1)]}),_:1})]),_:1},8,["label"])):b("",!0),(P=e(n))!=null&&P.data.found?(c(),p(f,{key:4,label:e(o)("page.ipList.label.firstTimeSeen"),span:2},{default:t(()=>{var i;return[l(s(e(N)(((i=e(n))==null?void 0:i.data.firstTimeSeen)??0,"long")),1)]}),_:1},8,["label"])):b("",!0),(fe=e(n))!=null&&fe.data.found?(c(),p(f,{key:5,label:e(o)("page.ipList.label.lastTimeSeen"),span:2},{default:t(()=>{var i;return[l(s(e(N)(((i=e(n))==null?void 0:i.data.lastTimeSeen)??0,"long")),1)]}),_:1},8,["label"])):b("",!0),(be=(me=e(n))==null?void 0:me.data.geo)!=null&&be.country||(he=(ye=e(n))==null?void 0:ye.data.geo)!=null&&he.city?(c(),p(f,{key:6,label:e(o)("page.banlist.banlist.listItem.geo"),span:2},{default:t(()=>{var i,I,q,M,O,Q,J,W;return[(I=(i=e(n).data.geo)==null?void 0:i.country)!=null&&I.iso?(c(),p(Ue,{key:0,iso:((M=(q=e(n).data.geo)==null?void 0:q.country)==null?void 0:M.iso)??""},null,8,["iso"])):b("",!0),l(" "+s(`${((Q=(O=e(n).data.geo)==null?void 0:O.country)==null?void 0:Q.name)??""} ${((W=(J=e(n).data.geo)==null?void 0:J.city)==null?void 0:W.name)??""}`),1)]}),_:1},8,["label"])):b("",!0),(Ie=(ke=(Se=e(n))==null?void 0:Se.data.geo)==null?void 0:ke.network)!=null&&Ie.isp?(c(),p(f,{key:7,label:e(o)("page.banlist.banlist.listItem.network.isp"),span:1},{default:t(()=>{var i,I;return[l(s((I=(i=e(n).data.geo)==null?void 0:i.network)==null?void 0:I.isp),1)]}),_:1},8,["label"])):b("",!0),(Te=(we=(ve=e(n))==null?void 0:ve.data.geo)==null?void 0:we.network)!=null&&Te.netType?(c(),p(f,{key:8,label:e(o)("page.banlist.banlist.listItem.network.netType"),span:2},{default:t(()=>{var i,I;return[l(s((I=(i=e(n).data.geo)==null?void 0:i.network)==null?void 0:I.netType),1)]}),_:1},8,["label"])):b("",!0),(Le=(ze=e(n))==null?void 0:ze.data.geo)!=null&&Le.as?(c(),p(f,{key:9,label:e(o)("page.banlist.banlist.listItem.asn"),span:2},{default:t(()=>[a(h,null,{default:t(()=>{var i,I,q,M,O,Q,J,W;return[a(_,null,{default:t(()=>{var x,C;return[l(s((C=(x=e(n).data.geo)==null?void 0:x.as)==null?void 0:C.organization),1)]}),_:1}),a(S,{color:e(xe)((((I=(i=e(n).data.geo)==null?void 0:i.as)==null?void 0:I.number)??0).toString())},{default:t(()=>{var x,C;return[l(s((C=(x=e(n).data.geo)==null?void 0:x.as)==null?void 0:C.number),1)]}),_:1},8,["color"]),a(r,{content:e(o)("page.banlist.banlist.listItem.asn.subnet")+((O=(M=(q=e(n).data.geo)==null?void 0:q.as)==null?void 0:M.network)==null?void 0:O.ipAddress)+"/"+((W=(J=(Q=e(n).data.geo)==null?void 0:Q.as)==null?void 0:J.network)==null?void 0:W.prefixLength)},{default:t(()=>{var x,C;return[a(B,{href:`https://2ip.io/analytics/asn-list/?asnId=${(C=(x=e(n).data.geo)==null?void 0:x.as)==null?void 0:C.number}`,hoverable:!1},{default:t(()=>[a(T)]),_:1},8,["href"])]}),_:1},8,["content"])]}),_:1})]),_:1},8,["label"])):b("",!0),a(f,{span:8},{label:t(()=>[a(h,null,{default:t(()=>[l(s(e(o)("page.ipList.shortcut"))+" ",1),a(y,{content:e(o)("page.ipList.shortcut.tips")},{default:t(()=>[a(T)]),_:1},8,["content"])]),_:1})]),default:t(()=>[a(h,null,{default:t(()=>[a(u,{href:`https://x.threatbook.com/v5/ip/${d.value}`,type:"outline"},{default:t(()=>g[2]||(g[2]=[l(" ThreatBook ")])),_:1},8,["href"]),a(u,{href:`https://search.censys.io/hosts/${d.value}`,type:"outline"},{default:t(()=>g[3]||(g[3]=[l(" Censys ")])),_:1},8,["href"])]),_:1})]),_:1})]}),_:1}),(H=e(n))!=null&&H.data.found?(c(),p(Ke,{key:0,bordered:!1,"destroy-on-hide":""},{default:t(()=>{var k,L,G,R;return[a(_e,{key:"1",header:e(o)("page.ipList.label.accessHistory"),disabled:!((k=v.value)!=null&&k.activated),class:"collapse-table"},Pe({"expand-icon":t(()=>{var P;return[(P=v.value)!=null&&P.activated?(c(),p(de,{key:0})):(c(),p(ue,{key:1}))]}),default:t(()=>[a(yt,{ip:d.value},null,8,["ip"])]),_:2},[(L=v.value)!=null&&L.activated?void 0:{name:"extra",fn:t(()=>[a(y,{content:e(o)("page.ipList.plusLock")},{default:t(()=>[a(S,{size:"small"},{default:t(()=>g[4]||(g[4]=[l("Plus")])),_:1})]),_:1},8,["content"])]),key:"0"}]),1032,["header","disabled"]),a(_e,{key:"2",header:e(o)("page.ipList.label.banHistory"),disabled:!((G=v.value)!=null&&G.activated)},Pe({"expand-icon":t(()=>{var P;return[(P=v.value)!=null&&P.activated?(c(),p(de,{key:0})):(c(),p(ue,{key:1}))]}),default:t(()=>[a(St,{ip:d.value},null,8,["ip"])]),_:2},[(R=v.value)!=null&&R.activated?void 0:{name:"extra",fn:t(()=>[a(y,{content:e(o)("page.ipList.plusLock")},{default:t(()=>[a(S,{size:"small"},{default:t(()=>g[5]||(g[5]=[l("Plus")])),_:1})]),_:1},8,["content"])]),key:"0"}]),1032,["header","disabled"])]}),_:1})):b("",!0)]}),_:1}))]),_:1},512),[[Je,((ge=e(n))==null?void 0:ge.data)||e(w)]])])]}),_:1})}}}),Ct=se(vt,[["__scopeId","data-v-c9887650"]]);export{Ct as default};
