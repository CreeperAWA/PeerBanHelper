import{u as le,h as $e,c as Z,f as T,I as se,b as ie,_ as ce,j as qe}from"./index-DoQflZMg.js";import{f as pe,a6 as re,a9 as Ae,a2 as e,j as i,s as p,t,y as a,v as l,x as s,p as D,k as ae,P as De,F as Fe,u as b,a1 as oe,w as Oe,c as Be,r as Qe,a8 as We,af as Je,o as Xe,M as Ye,N as Ze,E as He,m as et}from"./libs-Bsjl4Mfh.js";import{c as tt,d as at,e as nt}from"./data-De4L9cZy.js";import{a4 as Ke,S as ne,b as Ve,c as de,T as ue,o as je,E as ot,ak as lt,Q as st,y as it,w as ct,j as pt,D as rt,L as dt,B as ut,h as _t,U as gt,am as ft,an as mt,ao as bt,x as yt,ag as ht,H as St}from"./arcoDesign-C4SuNsa7.js";import{I as kt}from"./index-DTrbaGIX.js";import{I as It}from"./index-B2GE3e7T.js";const vt=pe({__name:"accessHistoryTable",props:{ip:{}},setup(ee){const{t:d,d:o}=re(),$=le(),{data:n,total:j,current:F,loading:w,pageSize:E,changeCurrent:S,changePageSize:B}=Ae(tt,{defaultParams:[{ip:ee.ip,page:1,pageSize:5}],pagination:{currentKey:"page",pageSizeKey:"pageSize",totalKey:"data.total"},cacheKey:m=>`${$.endpoint}-ipAccessHistory-${m==null?void 0:m[0].ip}-${(m==null?void 0:m[0].page)||1}-${(m==null?void 0:m[0].pageSize)||10}`}),te=[{title:"ID",dataIndex:"id"},{title:()=>d("page.torrentList.accessHistory.column.downloader"),slotName:"downloader"},{title:"Peer ID",slotName:"peerId"},{title:()=>d("page.torrentList.accessHistory.column.traffic"),slotName:"traffic"},{title:()=>oe(ne,[d("page.torrentList.accessHistory.column.offset"),oe(Ke,{content:d("page.torrentList.accessHistory.column.offsetDescription")},()=>oe(Z))]),slotName:"offset"},{title:"Flags",slotName:"flags"},{title:()=>d("page.torrentList.accessHistory.column.timeseen"),slotName:"time"}],g=m=>m.split(" ").map(_=>_+" - "+d("page.dashboard.peerList.column.flags."+_.trim()));return(m,_)=>{var z,V;const U=Ve,K=de,k=se,y=ue,h=ie,f=ne,G=je,M=ot;return(z=e(n))!=null&&z.data.results||e(w)?(i(),p(G,{key:0,stripe:!0,columns:te,data:(V=e(n))==null?void 0:V.data.results,loading:e(w),pagination:{total:e(j),current:e(F),pageSize:e(E),showPageSize:!0,baseSize:4,bufferSize:1},"column-resizable":"",size:"medium",class:"banlog-table",onPageChange:e(S),onPageSizeChange:e(B)},{downloader:t(({record:r})=>[a(U,{color:e($e)(r.downloader)},{default:t(()=>[l(s(r.downloader),1)]),_:2},1032,["color"])]),peerId:t(({record:r})=>[D("p",null,[l(s(r.peerId?r.peerId:e(d)("page.banlist.banlist.listItem.empty"))+" ",1),a(K,{content:r.clientName?r.clientName:e(d)("page.banlist.banlist.listItem.empty")},{default:t(()=>[a(e(Z))]),_:2},1032,["content"])])]),traffic:t(({record:r})=>[a(f,{fill:"",direction:"vertical"},{default:t(()=>[a(y,null,{default:t(()=>[a(k,{class:"green"}),l(" "+s(e(T)(r.uploaded)),1)]),_:2},1024),a(y,null,{default:t(()=>[a(h,{class:"red"}),l(" "+s(e(T)(r.downloaded)),1)]),_:2},1024)]),_:2},1024)]),offset:t(({record:r})=>[a(f,{fill:"",direction:"vertical"},{default:t(()=>[a(y,null,{default:t(()=>[a(k,{class:"green"}),l(" "+s(e(T)(r.uploadedOffset)),1)]),_:2},1024),a(y,null,{default:t(()=>[a(h,{class:"red"}),l(" "+s(e(T)(r.downloadedOffset)),1)]),_:2},1024)]),_:2},1024)]),flags:t(({record:r})=>[D("p",null,[l(s(r.lastFlags)+" ",1),r.lastFlags?(i(),p(K,{key:0},{content:t(()=>[(i(!0),ae(Fe,null,De(g(r.lastFlags),u=>(i(),ae("p",{key:u},s(u),1))),128))]),default:t(()=>[a(e(Z))]),_:2},1024)):b("",!0)])]),time:t(({record:r})=>[a(f,{fill:"",direction:"vertical"},{default:t(()=>[a(y,null,{default:t(()=>[l(s(e(d)("page.torrentList.accessHistory.column.timeseen.first"))+": "+s(e(o)(r.firstTimeSeen,"long")),1)]),_:2},1024),a(y,null,{default:t(()=>[l(s(e(d)("page.torrentList.accessHistory.column.timeseen.last"))+": "+s(e(o)(r.lastTimeSeen,"long")),1)]),_:2},1024)]),_:2},1024)]),_:1},8,["data","loading","pagination","onPageChange","onPageSizeChange"])):(i(),p(M,{key:1,style:{height:"20vh","align-items":"center",display:"flex","justify-content":"center","flex-direction":"column"}},{default:t(()=>[l(s(e(d)("page.torrentList.accessHistory.empty")),1)]),_:1}))}}}),wt=ce(vt,[["__scopeId","data-v-eb19a4ad"]]),zt=pe({__name:"banHistoryTable",props:{ip:{}},setup(ee){const d=le(),{t:o,d:$}=re(),{data:n,total:j,current:F,loading:w,pageSize:E,changeCurrent:S,changePageSize:B,refresh:te}=Ae(at,{defaultParams:[{ip:ee.ip,page:1,pageSize:10}],pagination:{currentKey:"page",pageSizeKey:"pageSize",totalKey:"data.total"},cacheKey:_=>`${d.endpoint}-banlogs-${(_==null?void 0:_[0].page)||1}-${(_==null?void 0:_[0].pageSize)||10}`});Oe(()=>d.endpoint,te);const g=[{title:()=>o("page.banlog.banlogTable.column.banTime")+"/"+o("page.banlog.banlogTable.column.unbanTime"),slotName:"banAt",width:210},{title:()=>o("page.banlog.banlogTable.column.peerPort"),dataIndex:"peerPort",width:80},{title:()=>o("page.banlog.banlogTable.column.peerId"),slotName:"peerId",width:120},{title:()=>o("page.banlog.banlogTable.column.trafficSnapshot"),slotName:"peerStatus",width:150},{title:()=>o("page.banlog.banlogTable.column.torrentName"),dataIndex:"torrentName",ellipsis:!0,tooltip:!0},{title:()=>o("page.banlog.banlogTable.column.torrentSize"),slotName:"torrentSize",width:120},{title:()=>o("page.banlog.banlogTable.column.description"),dataIndex:"description",ellipsis:!0,tooltip:!0}],m=Be(()=>{var _;return(_=n.value)==null?void 0:_.data.results});return(_,U)=>{const K=kt,k=ue,y=lt,h=ne,f=se,G=ie,M=st,z=de,V=Z,r=je;return i(),p(r,{stripe:!0,columns:g,data:m.value,loading:e(w),pagination:{total:e(j),current:e(F),pageSize:e(E),showPageSize:!0,baseSize:4,bufferSize:1},"column-resizable":"",size:"medium",class:"banlog-table",onPageChange:e(S),onPageSizeChange:e(B)},{banAt:t(({record:u})=>[a(h,{fill:"",direction:"vertical"},{default:t(()=>[a(k,null,{default:t(()=>[a(K),l(" "+s(e($)(u.banAt,"long")),1)]),_:2},1024),a(k,null,{default:t(()=>[a(y),l(" "+s(u.unbanAt?e($)(u.unbanAt,"long"):e(o)("page.banlog.banlogTable.notUnbanned")),1)]),_:2},1024)]),_:2},1024)]),peerStatus:t(({record:u})=>[a(h,{fill:"",style:{"justify-content":"space-between"}},{default:t(()=>[a(h,{fill:"",direction:"vertical"},{default:t(()=>[a(k,null,{default:t(()=>[a(f,{class:"green"}),l(" "+s(e(T)(u.peerUploaded)),1)]),_:2},1024),a(k,null,{default:t(()=>[a(G,{class:"red"}),l(" "+s(e(T)(u.peerDownloaded)),1)]),_:2},1024)]),_:2},1024),a(z,{content:(u.peerProgress*100).toFixed(2)+"%"},{default:t(()=>[a(M,{percent:u.peerProgress,size:"mini"},null,8,["percent"])]),_:2},1032,["content"])]),_:2},1024)]),peerId:t(({record:u})=>[D("p",null,[l(s(u.peerId?u.peerId:e(o)("page.banlist.banlist.listItem.empty"))+" ",1),a(z,{content:u.peerClientName?u.peerClientName:e(o)("page.banlist.banlist.listItem.empty")},{default:t(()=>[a(V)]),_:2},1032,["content"])])]),torrentSize:t(({record:u})=>[a(z,{content:`Hash: ${u.torrentInfoHash}`},{default:t(()=>[D("p",null,s(e(T)(u.torrentSize)),1)]),_:2},1032,["content"])]),_:1},8,["data","loading","pagination","onPageChange","onPageSizeChange"])}}}),Tt=ce(zt,[["__scopeId","data-v-733c65d5"]]),Lt={class:"center searchContainer"},Pt={class:"result-container center"},xt=pe({__name:"index",setup(ee){const d=Qe(""),{t:o,d:$}=re(),{data:n,loading:j,run:F,error:w}=We(nt,{manual:!0}),E=le(),S=Be(()=>E.plusStatus),{query:B}=Je();return Xe(()=>{B.ip&&(d.value=B.ip,F(d.value))}),(te,g)=>{const m=it,_=ue,U=ct,K=pt,k=Ve,y=Ke,h=ne,f=rt,G=se,M=ie,z=Z,V=dt,r=de,u=ut,Ee=_t,_e=gt,ge=ft,fe=It,me=mt,Ue=bt,Ge=yt,Me=ht,Re=St;return i(),p(h,{direction:"vertical",fill:"",class:"center"},{default:t(()=>{var be,ye;return[a(U,{style:{"text-align":"center"}},{default:t(()=>[a(m,null,{default:t(()=>[l(s(e(o)("page.ipList.title")),1)]),_:1}),a(_,null,{default:t(()=>[l(s(e(o)("page.ipList.description")),1)]),_:1})]),_:1}),D("div",Lt,[a(K,{modelValue:d.value,"onUpdate:modelValue":g[0]||(g[0]=A=>d.value=A),"search-button":"",placeholder:"192.168.1.1....",class:"searchBox",loading:e(j),onSearch:e(F)},null,8,["modelValue","loading","onSearch"])]),D("div",Pt,[Ye(a(Re,{class:"result-card",style:et({minWidth:(be=e(n))!=null&&be.data.found?"1150px":"400px"}),hoverable:""},{default:t(()=>[e(w)?(i(),p(Me,{key:1,status:"500",title:e(o)("page.ipList.error"),subtitle:e(w).message},{default:t(()=>[a(U,{style:{background:"var(--color-fill-2)",padding:"24px"}},{default:t(()=>{var A;return[a(Ge,null,{default:t(()=>g[6]||(g[6]=[l("Details:")])),_:1}),D("ul",null,[(i(!0),ae(Fe,null,De((A=e(w).stack)==null?void 0:A.split(`
`),I=>(i(),ae("li",{key:I},s(I),1))),128))])]}),_:1})]),_:1},8,["title","subtitle"])):(i(),p(h,{key:0,direction:"vertical",fill:""},{default:t(()=>{var A;return[a(Ee,null,{title:t(()=>[a(h,null,{default:t(()=>{var I,L;return[l(s((I=e(n))==null?void 0:I.data.address)+" ",1),(L=e(n))!=null&&L.data.found?b("",!0):(i(),p(y,{key:0,content:e(o)("page.ipList.notfound.tips")},{default:t(()=>[a(k,null,{default:t(()=>g[1]||(g[1]=[l("Not found")])),_:1})]),_:1},8,["content"]))]}),_:1})]),default:t(()=>{var I,L,R,q,P,x,C,he,Se,ke,Ie,ve,we,ze,Te,Le,Pe,xe,Ce,Ne;return[(I=e(n))!=null&&I.data.found?(i(),p(f,{key:0,label:e(o)("page.ipList.label.banCount"),span:2},{default:t(()=>{var c;return[l(s((c=e(n))==null?void 0:c.data.banCount),1)]}),_:1},8,["label"])):b("",!0),(L=e(n))!=null&&L.data.found?(i(),p(f,{key:1,label:e(o)("page.ipList.label.torrentAccessCount"),span:2},{default:t(()=>{var c;return[l(s((c=e(n))==null?void 0:c.data.torrentAccessCount),1)]}),_:1},8,["label"])):b("",!0),(R=e(n))!=null&&R.data.found?(i(),p(f,{key:2,label:e(o)("page.ipList.label.uploadedToPeer"),span:2},{default:t(()=>[a(_,null,{default:t(()=>{var c;return[a(G,{class:"green"}),l(" "+s(e(T)(((c=e(n))==null?void 0:c.data.uploadedToPeer)??0)),1)]}),_:1})]),_:1},8,["label"])):b("",!0),(q=e(n))!=null&&q.data.found?(i(),p(f,{key:3,label:e(o)("page.ipList.label.downloadedFromPeer"),span:2},{default:t(()=>[a(_,null,{default:t(()=>{var c;return[a(M,{class:"red"}),l(" "+s(e(T)(((c=e(n))==null?void 0:c.data.downloadedFromPeer)??0)),1)]}),_:1})]),_:1},8,["label"])):b("",!0),(P=e(n))!=null&&P.data.found?(i(),p(f,{key:4,label:e(o)("page.ipList.label.firstTimeSeen"),span:2},{default:t(()=>{var c;return[l(s(e($)(((c=e(n))==null?void 0:c.data.firstTimeSeen)??0,"long")),1)]}),_:1},8,["label"])):b("",!0),(x=e(n))!=null&&x.data.found?(i(),p(f,{key:5,label:e(o)("page.ipList.label.lastTimeSeen"),span:2},{default:t(()=>{var c;return[l(s(e($)(((c=e(n))==null?void 0:c.data.lastTimeSeen)??0,"long")),1)]}),_:1},8,["label"])):b("",!0),(Se=(he=(C=e(n))==null?void 0:C.data.geo)==null?void 0:he.country)!=null&&Se.iso||(ve=(Ie=(ke=e(n))==null?void 0:ke.data.geo)==null?void 0:Ie.city)!=null&&ve.name?(i(),p(f,{key:6,label:e(o)("page.banlist.banlist.listItem.geo"),span:2},{default:t(()=>{var c,v,O,Q,W,J,X,Y;return[(v=(c=e(n).data.geo)==null?void 0:c.country)!=null&&v.iso?(i(),p(qe,{key:0,iso:((Q=(O=e(n).data.geo)==null?void 0:O.country)==null?void 0:Q.iso)??""},null,8,["iso"])):b("",!0),l(" "+s(`${((J=(W=e(n).data.geo)==null?void 0:W.country)==null?void 0:J.name)??""} ${((Y=(X=e(n).data.geo)==null?void 0:X.city)==null?void 0:Y.name)??""}`),1)]}),_:1},8,["label"])):b("",!0),(Te=(ze=(we=e(n))==null?void 0:we.data.geo)==null?void 0:ze.network)!=null&&Te.isp?(i(),p(f,{key:7,label:e(o)("page.banlist.banlist.listItem.network.isp"),span:1},{default:t(()=>{var c,v;return[l(s((v=(c=e(n).data.geo)==null?void 0:c.network)==null?void 0:v.isp),1)]}),_:1},8,["label"])):b("",!0),(xe=(Pe=(Le=e(n))==null?void 0:Le.data.geo)==null?void 0:Pe.network)!=null&&xe.netType?(i(),p(f,{key:8,label:e(o)("page.banlist.banlist.listItem.network.netType"),span:2},{default:t(()=>{var c,v;return[l(s((v=(c=e(n).data.geo)==null?void 0:c.network)==null?void 0:v.netType),1)]}),_:1},8,["label"])):b("",!0),(Ne=(Ce=e(n))==null?void 0:Ce.data.geo)!=null&&Ne.as?(i(),p(f,{key:9,label:e(o)("page.banlist.banlist.listItem.asn"),span:2},{default:t(()=>[a(h,null,{default:t(()=>{var c,v,O,Q,W,J,X,Y;return[a(_,null,{default:t(()=>{var N,H;return[l(s((H=(N=e(n).data.geo)==null?void 0:N.as)==null?void 0:H.organization),1)]}),_:1}),a(k,{color:e($e)((((v=(c=e(n).data.geo)==null?void 0:c.as)==null?void 0:v.number)??0).toString())},{default:t(()=>{var N,H;return[l(s((H=(N=e(n).data.geo)==null?void 0:N.as)==null?void 0:H.number),1)]}),_:1},8,["color"]),a(r,{content:e(o)("page.banlist.banlist.listItem.asn.subnet")+((W=(Q=(O=e(n).data.geo)==null?void 0:O.as)==null?void 0:Q.network)==null?void 0:W.ipAddress)+"/"+((Y=(X=(J=e(n).data.geo)==null?void 0:J.as)==null?void 0:X.network)==null?void 0:Y.prefixLength)},{default:t(()=>{var N,H;return[a(V,{href:`https://2ip.io/analytics/asn-list/?asnId=${(H=(N=e(n).data.geo)==null?void 0:N.as)==null?void 0:H.number}`,hoverable:!1},{default:t(()=>[a(z)]),_:1},8,["href"])]}),_:1},8,["content"])]}),_:1})]),_:1},8,["label"])):b("",!0),a(f,{span:8},{label:t(()=>[a(h,null,{default:t(()=>[l(s(e(o)("page.ipList.shortcut"))+" ",1),a(y,{content:e(o)("page.ipList.shortcut.tips")},{default:t(()=>[a(z)]),_:1},8,["content"])]),_:1})]),default:t(()=>[a(h,null,{default:t(()=>[a(u,{href:`https://ip.ping0.cc/ip/${d.value}`,type:"outline"},{default:t(()=>g[2]||(g[2]=[l(" ping0 ")])),_:1},8,["href"]),a(u,{href:`https://search.censys.io/hosts/${d.value}`,type:"outline"},{default:t(()=>g[3]||(g[3]=[l(" Censys ")])),_:1},8,["href"])]),_:1})]),_:1})]}),_:1}),(A=e(n))!=null&&A.data.found?(i(),p(Ue,{key:0,bordered:!1,"destroy-on-hide":""},{default:t(()=>{var I,L,R,q;return[a(me,{key:"1",header:e(o)("page.ipList.label.accessHistory"),disabled:!((I=S.value)!=null&&I.activated),class:"collapse-table"},He({"expand-icon":t(({active:P})=>{var x,C;return[(x=S.value)!=null&&x.activated&&!P?(i(),p(_e,{key:0})):(C=S.value)!=null&&C.activated&&P?(i(),p(ge,{key:1})):(i(),p(fe,{key:2}))]}),default:t(()=>[a(wt,{ip:d.value},null,8,["ip"])]),_:2},[(L=S.value)!=null&&L.activated?void 0:{name:"extra",fn:t(()=>[a(y,{content:e(o)("page.ipList.plusLock")},{default:t(()=>[a(k,{size:"small"},{default:t(()=>g[4]||(g[4]=[l("Plus")])),_:1})]),_:1},8,["content"])]),key:"0"}]),1032,["header","disabled"]),a(me,{key:"2",header:e(o)("page.ipList.label.banHistory"),disabled:!((R=S.value)!=null&&R.activated)},He({"expand-icon":t(({active:P})=>{var x,C;return[(x=S.value)!=null&&x.activated&&!P?(i(),p(_e,{key:0})):(C=S.value)!=null&&C.activated&&P?(i(),p(ge,{key:1})):(i(),p(fe,{key:2}))]}),default:t(()=>[a(Tt,{ip:d.value},null,8,["ip"])]),_:2},[(q=S.value)!=null&&q.activated?void 0:{name:"extra",fn:t(()=>[a(y,{content:e(o)("page.ipList.plusLock")},{default:t(()=>[a(k,{size:"small"},{default:t(()=>g[5]||(g[5]=[l("Plus")])),_:1})]),_:1},8,["content"])]),key:"0"}]),1032,["header","disabled"])]}),_:1})):b("",!0)]}),_:1}))]),_:1},8,["style"]),[[Ze,((ye=e(n))==null?void 0:ye.data)||e(w)]])])]}),_:1})}}}),Ft=ce(xt,[["__scopeId","data-v-7512876e"]]);export{Ft as default};
